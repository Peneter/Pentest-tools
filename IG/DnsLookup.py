import os
import socket
import subprocess
Target = raw_input ("Please Enter Your Target IP : \n")
##################################################################
def GetHostIP(host):
    NSrecord = os.system("host %s>Br_%s.txt"%(host,host))
    f=open("Br_%s.txt"%host,"r")
    print "%s ->"%host,
    for i in f:
        t=i.split("address ",2)[1].strip()
        print t,

def ZoneTransfer(ns,host,method):
    #print "dig %s @%s %s>Br_ZT_%s_%s.txt"%(method,ns,host,ns,method)
    os.system("dig %s @%s %s>Br_ZT_%s_%s.txt"%(method,ns,host,ns,method))
    z=open("Br_ZT_%s_%s.txt"%(ns,method),"r")
    if "Transfer failed" or "not available" in z.read():
        print " --> Transfer failed "
    else:
        print z.read()
        z.close()

def DNSlookup(Target):
    Arecord = subprocess.check_output("host -t A %s"%Target, shell=True)
    print ("-"*75+"\n A record :\n"+Arecord)
    AAAArecord = subprocess.check_output("host -t AAAA %s"%Target, shell=True)
    print ("-"*75+"\n AAAA record :\n"+AAAArecord)
    NSrecord = subprocess.check_output("host -t NS %s>NS.txt"%Target, shell=True)
    f=open("NS.txt","r")
    print "-"*75+" \n NS record :"
    for i in f:
        t=i.split(" ",3)[3].strip()
        f=t[:-1]
        GetHostIP(f)
        print "\n"
    SOArecord = subprocess.check_output("host -t SOA %s"%Target, shell=True)
    print ("-"*75+"\n SOA record :\n"+SOArecord)
    MXrecord = subprocess.check_output("host -t MX %s>MX.txt"%Target, shell=True)
    print ("-"*75+"\n MX record :"+MXrecord)
    m=open("MX.txt","r")
    print m.read()
    m.close()
    m=open("MX.txt","r")
    for i in m:
        t=i.split(" ",6)[6].strip()
        m=t[:-1]
        GetHostIP(m)
        print "\n"
    PTRrecord = subprocess.check_output("host -t PTR %s"%Target, shell=True)
    print ("-"*75+"\n PTR record :\n"+PTRrecord)
    CNAMErecord = subprocess.check_output("host -t CNAME %s"%Target, shell=True)
    print ("-"*75+"\n CNAME record :\n"+CNAMErecord)
    TXTrecord = subprocess.check_output("host -t TXT %s"%Target, shell=True)
    print ("-"*75+"\n TXT record :\n"+TXTrecord)
    CAArecord = subprocess.check_output("host -t CAA %s"%Target, shell=True)
    print ("-"*75+"\n CAA record :\n"+CAArecord)
    AFSDB = subprocess.check_output("host -t AFSDB %s"%Target, shell=True)
    print ("-"*75+"\n AFS database record :\n"+AFSDB)
    APL = subprocess.check_output("host -t APL %s"%Target, shell=True)
    print ("-"*75+"\n Address Prefix List record :\n"+APL)
    CDNSKEY = subprocess.check_output("host -t CDNSKEY %s"%Target, shell=True)
    print ("-"*75+"\n Child DNSKEY record :\n"+CDNSKEY)
    CDS = subprocess.check_output("host -t CDS %s"%Target, shell=True)
    print ("-"*75+"\n Child DS record :\n"+CDS)
    DHCID = subprocess.check_output("host -t DHCID %s"%Target, shell=True)
    print ("-"*75+"\n DHCP identifier record :\n"+DHCID)
    DLV = subprocess.check_output("host -t DLV %s"%Target, shell=True)
    print ("-"*75+"\n DNSSEC Lookaside Validation record :\n"+DLV)
    DNSKEY = subprocess.check_output("host -t DNSKEY %s"%Target, shell=True)
    print ("-"*75+"\n DNS Key record :\n"+DNSKEY)
    DS = subprocess.check_output("host -t DS %s"%Target, shell=True)
    print ("-"*75+"\n Delegation signer record :\n"+DS)
    HIP = subprocess.check_output("host -t HIP %s"%Target, shell=True)
    print ("-"*75+"\n Host Identity Protocol :\n"+HIP)
    IPSECKEY = subprocess.check_output("host -t IPSECKEY %s"%Target, shell=True)
    print ("-"*75+"\n IPsec Key :\n"+IPSECKEY)
    KEY = subprocess.check_output("host -t KEY %s"%Target, shell=True)
    print ("-"*75+"\n Key record :\n"+KEY)
    KX = subprocess.check_output("host -t KX %s"%Target, shell=True)
    print ("-"*75+"\n Key Exchanger record :\n"+KX)
    LOC = subprocess.check_output("host -t LOC %s"%Target, shell=True)
    print ("-"*75+"\n Location record :\n"+LOC)
    NAPTR = subprocess.check_output("host -t NAPTR %s"%Target, shell=True)
    print ("-"*75+"\n Naming Authority Pointer :\n"+NAPTR)
    NSEC = subprocess.check_output("host -t NSEC %s"%Target, shell=True)
    print ("-"*75+"\n Next Secure record :\n"+NSEC)
    NSEC3 = subprocess.check_output("host -t NSEC3 %s"%Target, shell=True)
    print ("-"*75+"\n Next Secure record version 3 :\n"+NSEC3)
    NSEC3PARAM = subprocess.check_output("host -t NSEC3PARAM %s"%Target, shell=True)
    print ("-"*75+"\n NSEC3 parameters :\n"+NSEC3PARAM)
    RRSIG = subprocess.check_output("host -t RRSIG %s"%Target, shell=True)
    print ("-"*75+"\n DNSSEC signature :\n"+RRSIG)
    RP = subprocess.check_output("host -t RP %s"%Target, shell=True)
    print ("-"*75+"\n Responsible Person signature :\n"+RP)
    SIG = subprocess.check_output("host -t SIG %s"%Target, shell=True)
    print ("-"*75+"\n Signature :\n"+SIG)
    SRV = subprocess.check_output("host -t SRV %s"%Target, shell=True)
    print ("-"*75+"\n Service locator :\n"+SRV)
    SSHFP = subprocess.check_output("host -t SSHFP %s"%Target, shell=True)
    print ("-"*75+"\n SSH Public Key Fingerprint :\n"+SSHFP)
    TKEY = subprocess.check_output("host -t TKEY %s"%Target, shell=True)
    print ("-"*75+"\n Transaction Key record :\n"+TKEY)
    TLSA = subprocess.check_output("host -t TLSA %s"%Target, shell=True)
    print ("-"*75+"\n TLSA certificate association :\n"+TLSA)
    TSIG = subprocess.check_output("host -t TSIG %s"%Target, shell=True)
    print ("-"*75+"\n Transaction Signature :\n"+TSIG)
    URI = subprocess.check_output("host -t URI %s"%Target, shell=True)
    print ("-"*75+"\n Uniform Resource Identifier :\n"+URI)

##################################################################
#                       Zone Transfer ...
##################################################################
    print "="*75
    print "  Zone Transfering With 3 Method ( AXFR IXFR OPT ) ..."
    f=open("NS.txt","r")
    for i in f:
        t=i.split(" ",3)[3].strip()
        f=t[:-1]
        print "="*75
        print "Authoritative Zone Transfer For %s ..."%f
        ZoneTransfer(f,Target,"AXFR")
        print "-"*75
        print "Incremental Zone Transfer For %s ..."%f
        ZoneTransfer(f,Target,"IXFR")
        print "-"*75
        print "pseudo DNS record type Zone Transfer For %s ..."%f
        ZoneTransfer(f,Target,"OPT")
        print "\n"
    print " https://en.wikipedia.org/wiki/List_of_DNS_record_types"
##################################################################
#                           Main
##################################################################
print "="*75
print "\t\t\tYour Target : "+Target
try:
    E=subprocess.check_output("host.exe %s"%Target, shell=True)
    if("not found: 3(NXDOMAIN)" in E):
        print("="*75+"\n This Domain Not Exist :( ")
    else:
        DNSlookup(Target)
except:
    print("="*75+"\n Operation Failed :( ")
print "="*75
print "="*75
print " All Process Finished "
os.system("del /F Br_*.txt MX.txt NS.txt")
